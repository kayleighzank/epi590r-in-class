---
title: "gtsummary in quarto"
format:
  html:
    theme: lumen
execute:
  echo: false
---

The NLS, sponsored by the U.S. Bureau of Labor Statistics, are nationally representative surveys that follow the same sample of individuals from specific birth cohorts over time. The surveys collect data on labor market activity, schooling, fertility, program participation, health, and much more.

```{r}
#| message: false
library(tidyverse)
library(gtsummary)
nlsy_cols <- c("glasses", "eyesight", "sleep_wkdy", "sleep_wknd", 
               "id", "nsibs", "samp", "race_eth", "sex", "region", 
               "income", "res_1980", "res_2002", "age_bir")
nlsy <- read_csv(here::here("data", "raw", "nlsy.csv"), 
                 na = c("-1", "-2", "-3", "-4", "-5", "-998"),
                 skip = 1, col_names = nlsy_cols) |> 
  mutate(region_cat = factor(region, labels = c("Northeast", "North Central", "South", "West")),
         sex_cat = factor(sex, labels = c("Male", "Female")),
         race_eth_cat = factor(race_eth, labels = c("Hispanic", "Black", "Non-Black, Non-Hispanic")),
         eyesight_cat = factor(eyesight, labels = c("Excellent", "Very good", "Good", "Fair", "Poor")),
         glasses_cat = factor(glasses, labels = c("No", "Yes"))) 
```

# Customization of `tbl_summary()`

```{r}
tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(sex_cat, race_eth_cat, region_cat,
              eyesight_cat, glasses, age_bir))
```

```{r}
tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(sex_cat, race_eth_cat, region_cat,
              eyesight_cat, glasses, age_bir),
  label = list(
    race_eth_cat ~ "Race/ethnicity",
    region_cat ~ "Region",
    eyesight_cat ~ "Eyesight",
    glasses ~ "Wears glasses",
    age_bir ~ "Age at first birth"
  ),
  missing_text = "Missing")
```

2.2 Part 2 and 2.3 Exercises

@tbl-one shows the descriptive statistics of selected characteristics by sex.

```{r}
#| label: tbl-one
#| tbl-cap: "Cohort Characteristics Stratified by Sex"
tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(race_eth_cat, region_cat, 
  						eyesight_cat, glasses, age_bir),
  label = list(
    race_eth_cat ~ "Race/ethnicity",
    region_cat ~ "Region",
    eyesight_cat ~ "Eyesight",
    glasses ~ "Wears glasses",
    age_bir ~ "Age at first birth"
  ),
  missing_text = "Missing")


```

```{r}
#| echo: true
mean_sleep_wknd <- mean(nlsy$sleep_wknd, na.rm = TRUE)
mean_sleep_wknd
```

The mean number of hours of sleep on weekends among the cohort was `r round(mean_sleep_wknd, 2)` .

The mean number of hours of sleep on weekends among the cohort was `r mean(nlsy$sleep_wknd, na.rm = TRUE)` .

```{r}
#| echo: true
median_sleep_wknd <- median(nlsy$sleep_wknd, na.rm = TRUE)
median_sleep_wknd
```

The median number of hours of sleep on weekends among the cohort was `r median_sleep_wknd` .

The median number of hours of sleep on weekends among the cohort was `r median(nlsy$sleep_wknd, na.rm = TRUE)` .

2.3 Part 2

```{r}
#| label: tabl-descr
#| table-cap: "Descriptive Statistics"
table1 <- tbl_summary(
	nlsy, 
	by = sex_cat,
	include = c(race_eth_cat, region_cat, eyesight_cat, glasses, age_bir),
	label = list(
    race_eth_cat ~ "Race/ethnicity",
    region_cat ~ "Region",
    eyesight_cat ~ "Eyesight",
    glasses ~ "Wears glasses",
    age_bir ~ "Age at first birth")
) %>%
	add_overall(last = TRUE)

table1

male_birth_miqr <- inline_text(table1, variable = "age_bir", column = "stat_1")

ss_glasses <- inline_text(table1, variable = "glasses", column = "stat_0", pattern = "{n}/{N} ({p}%)")
```

Male participants had a median age at birth of their first child of `r male_birth_miqr`.

The proportion of people who wear glasses is `r ss_glasses`.

```{r}
#| label: tabl-part7
#| table-cap: "2.3 Exercises Part 7"
table_part_7 <- tbl_summary(
	nlsy, 
	by = sex_cat,
	include = sleep_wknd,
	label = 
		sleep_wknd ~ "Hours of Sleep on Weekend",
	missing_text = "Missing",
	statistic = sleep_wknd ~ "{median}"
) %>%
	add_overall()

table_part_7

overall_median_sleep_weekend <- inline_text(table_part_7, variable = sleep_wknd, column = "stat_0")
```

The median hours of sleep on weekends of the cohort was `r overall_median_sleep_weekend`.
